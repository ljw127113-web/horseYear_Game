# å®Œæ•´éƒ¨ç½²æŒ‡å— - Netlify + Railway/Render

## ğŸ“‹ ç›®å½•

1. [å‰ç½®å‡†å¤‡](#å‰ç½®å‡†å¤‡)
2. [æ–¹æ¡ˆä¸€ï¼šRailwayéƒ¨ç½²ï¼ˆæ¨èï¼‰](#æ–¹æ¡ˆä¸€railwayéƒ¨ç½²æ¨è)
3. [æ–¹æ¡ˆäºŒï¼šRenderéƒ¨ç½²ï¼ˆå…è´¹æ›¿ä»£ï¼‰](#æ–¹æ¡ˆäºŒrenderéƒ¨ç½²å…è´¹æ›¿ä»£)
4. [Netlifyé™æ€æ–‡ä»¶éƒ¨ç½²](#netlifyé™æ€æ–‡ä»¶éƒ¨ç½²)
5. [é…ç½®è¿æ¥](#é…ç½®è¿æ¥)
6. [æµ‹è¯•éªŒè¯](#æµ‹è¯•éªŒè¯)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å‰ç½®å‡†å¤‡

### éœ€è¦çš„è´¦å·
- âœ… GitHubè´¦å·ï¼ˆå·²æœ‰ï¼Œå› ä¸ºä½ ä½¿ç”¨Gitä»“åº“ï¼‰
- âœ… Netlifyè´¦å·ï¼ˆå…è´¹ï¼‰
- âœ… Railwayè´¦å· æˆ– Renderè´¦å·ï¼ˆå…è´¹ï¼‰

### ç¡®ä¿æ–‡ä»¶å·²æäº¤åˆ°Git
æ‰€æœ‰æ–‡ä»¶éƒ½åº”è¯¥åœ¨Gitä»“åº“ä¸­ï¼š
- âœ… `index.html`
- âœ… `player.html`
- âœ… `game.js`
- âœ… `style.css`
- âœ… `default-config.json`
- âœ… `version.json`
- âœ… `server.js`
- âœ… `package.json`

---

## æ–¹æ¡ˆä¸€ï¼šRailwayéƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ­¥éª¤1ï¼šéƒ¨ç½²WebSocketæœåŠ¡å™¨åˆ°Railway

1. **è®¿é—®Railwayå¹¶æ³¨å†Œ**
   - æ‰“å¼€ https://railway.app
   - ç‚¹å‡» "Start a New Project"
   - é€‰æ‹© "Login with GitHub"ï¼ˆä½¿ç”¨GitHubè´¦å·ç™»å½•ï¼‰

2. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo"
   - é€‰æ‹©ä½ çš„Gitä»“åº“
   - Railwayä¼šè‡ªåŠ¨æ£€æµ‹åˆ°Node.jsé¡¹ç›®

3. **é…ç½®éƒ¨ç½²**
   - Railwayä¼šè‡ªåŠ¨è¯†åˆ« `package.json` å’Œ `server.js`
   - å¦‚æœéœ€è¦æ‰‹åŠ¨é…ç½®ï¼š
     - **Root Directory**: `/` (ç•™ç©ºï¼Œä½¿ç”¨æ ¹ç›®å½•)
     - **Build Command**: å¯ä»¥ç•™ç©ºï¼Œæˆ–å¡«å†™ `npm install`
     - **Start Command**: `node server.js`

4. **è·å–éƒ¨ç½²URL**
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸1-2åˆ†é’Ÿï¼‰
   - éƒ¨ç½²å®Œæˆåï¼ŒRailwayä¼šæ˜¾ç¤ºä¸€ä¸ªå…¬å…±URL
   - æ ¼å¼ç±»ä¼¼ï¼š`your-project.up.railway.app`
   - **é‡è¦**ï¼šè®°å½•è¿™ä¸ªURLï¼ˆä¸åŒ…å«åè®®ï¼‰

5. **è·å–WebSocketåœ°å€**
   - Railwayçš„WebSocketåœ°å€æ ¼å¼ï¼š`wss://your-project.up.railway.app`
   - **æ³¨æ„**ï¼šä½¿ç”¨ `wss://`ï¼ˆå®‰å…¨WebSocketï¼‰è€Œä¸æ˜¯ `ws://`
   - è®°å½•è¿™ä¸ªå®Œæ•´åœ°å€

### æ­¥éª¤2ï¼šéªŒè¯Railwayéƒ¨ç½²

1. **æŸ¥çœ‹æ—¥å¿—**
   - åœ¨Railwayé¡¹ç›®é¡µé¢ï¼Œç‚¹å‡» "View Logs"
   - åº”è¯¥çœ‹åˆ°ï¼š`WebSocketæœåŠ¡å™¨å¯åŠ¨åœ¨ç«¯å£ XXXX`

2. **æµ‹è¯•è¿æ¥**
   - å¯ä»¥ä½¿ç”¨åœ¨çº¿WebSocketæµ‹è¯•å·¥å…·
   - æˆ–ç›´æ¥é€šè¿‡æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•

---

## æ–¹æ¡ˆäºŒï¼šRenderéƒ¨ç½²ï¼ˆå…è´¹æ›¿ä»£ï¼‰

### æ­¥éª¤1ï¼šéƒ¨ç½²WebSocketæœåŠ¡å™¨åˆ°Render

1. **è®¿é—®Renderå¹¶æ³¨å†Œ**
   - æ‰“å¼€ https://render.com
   - ç‚¹å‡» "Get Started for Free"
   - ä½¿ç”¨GitHubè´¦å·ç™»å½•

2. **åˆ›å»ºWeb Service**
   - åœ¨Dashboardç‚¹å‡» "New +"
   - é€‰æ‹© "Web Service"
   - è¿æ¥ä½ çš„GitHubä»“åº“

3. **é…ç½®æœåŠ¡**
   - **Name**: `danmaku-boss-server` (æˆ–ä½ å–œæ¬¢çš„åå­—)
   - **Environment**: `Node`
   - **Region**: é€‰æ‹©ç¦»ä½ æœ€è¿‘çš„åŒºåŸŸ
   - **Branch**: `main` æˆ– `master`
   - **Root Directory**: `/` (ç•™ç©º)
   - **Build Command**: `npm install`
   - **Start Command**: `node server.js`
   - **Instance Type**: `Free`

4. **é«˜çº§è®¾ç½®ï¼ˆå¯é€‰ï¼‰**
   - **Auto-Deploy**: `Yes` (è‡ªåŠ¨éƒ¨ç½²)
   - **Health Check Path**: `/` (å¯ä»¥ç•™ç©º)

5. **åˆ›å»ºå¹¶ç­‰å¾…éƒ¨ç½²**
   - ç‚¹å‡» "Create Web Service"
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸2-3åˆ†é’Ÿï¼‰
   - Renderä¼šæä¾›ä¸€ä¸ª `*.onrender.com` åŸŸå

6. **è·å–WebSocketåœ°å€**
   - Renderçš„WebSocketåœ°å€æ ¼å¼ï¼š`wss://your-service.onrender.com`
   - **æ³¨æ„**ï¼šä½¿ç”¨ `wss://` åè®®

### æ­¥éª¤2ï¼šRenderæ³¨æ„äº‹é¡¹

âš ï¸ **Renderå…è´¹ç‰ˆé™åˆ¶**ï¼š
- æœåŠ¡ä¼šåœ¨15åˆ†é’Ÿä¸æ´»åŠ¨åè‡ªåŠ¨ä¼‘çœ 
- é¦–æ¬¡è®¿é—®éœ€è¦ç­‰å¾…å†·å¯åŠ¨ï¼ˆ10-30ç§’ï¼‰
- æ¯æœˆæœ‰é™åˆ¶çš„ä½¿ç”¨æ—¶é—´

ğŸ’¡ **è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨å¤–éƒ¨æœåŠ¡å®šæœŸpingä½ çš„æœåŠ¡å™¨é˜²æ­¢ä¼‘çœ 
- æˆ–å‡çº§åˆ°ä»˜è´¹è®¡åˆ’

---

## Netlifyé™æ€æ–‡ä»¶éƒ¨ç½²

### æ­¥éª¤1ï¼šè¿æ¥Gitä»“åº“

1. **ç™»å½•Netlify**
   - è®¿é—® https://app.netlify.com
   - ä½¿ç”¨GitHubè´¦å·ç™»å½•

2. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "Add new site" â†’ "Import an existing project"
   - é€‰æ‹© "Deploy with GitHub"
   - æˆæƒNetlifyè®¿é—®ä½ çš„GitHubè´¦å·
   - é€‰æ‹©åŒ…å«æ¸¸æˆä»£ç çš„ä»“åº“

### æ­¥éª¤2ï¼šé…ç½®æ„å»ºè®¾ç½®

åœ¨ "Site settings" â†’ "Build & deploy" â†’ "Build settings"ï¼š

- **Build command**: ç•™ç©ºï¼ˆä¸éœ€è¦æ„å»ºï¼‰
- **Publish directory**: `/` (æ ¹ç›®å½•)
- **Functions directory**: ç•™ç©º

æˆ–è€…ç›´æ¥åœ¨éƒ¨ç½²æ—¶å¡«å†™ï¼š
- Base directory: `/`
- Build command: `# ä¸éœ€è¦æ„å»º`
- Publish directory: `/`

### æ­¥éª¤3ï¼šéƒ¨ç½²

1. **å¼€å§‹éƒ¨ç½²**
   - ç‚¹å‡» "Deploy site"
   - Netlifyä¼šè‡ªåŠ¨å¼€å§‹éƒ¨ç½²

2. **è·å–NetlifyåŸŸå**
   - éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªåŸŸå
   - æ ¼å¼ï¼š`https://your-site-name.netlify.app`
   - æˆ–è‡ªå®šä¹‰åŸŸåï¼š`https://your-custom-domain.com`

3. **é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰**
   - åœ¨ "Domain settings" ä¸­
   - ç‚¹å‡» "Add custom domain"
   - æŒ‰ç…§æç¤ºé…ç½®DNS

---

## é…ç½®è¿æ¥

### æ–¹æ³•1ï¼šé€šè¿‡URLå‚æ•°é…ç½®ï¼ˆæ¨èï¼‰

**ä¸»æ¸¸æˆç•Œé¢**ï¼š
```
https://your-site.netlify.app/index.html?ws=wss://your-server.railway.app
```

**ç©å®¶ç«¯**ï¼š
```
https://your-site.netlify.app/player.html?ws=wss://your-server.railway.app
```

### æ–¹æ³•2ï¼šä¿®æ”¹ä»£ç ä¸­çš„é»˜è®¤åœ°å€

ç¼–è¾‘ `game.js`ï¼Œæ‰¾åˆ° `getWebSocketUrl()` å‡½æ•°ï¼Œä¿®æ”¹ç”Ÿäº§ç¯å¢ƒé»˜è®¤åœ°å€ï¼š

```javascript
// åœ¨ game.js ä¸­
if (hostname.includes('netlify.app')) {
    return 'wss://your-server.railway.app'; // æ›¿æ¢ä¸ºå®é™…åœ°å€
}
```

### æ–¹æ³•3ï¼šä½¿ç”¨Netlifyç¯å¢ƒå˜é‡ï¼ˆé«˜çº§ï¼‰

1. åœ¨Netlifyé¡¹ç›®è®¾ç½®ä¸­ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - é”®ï¼š`WS_SERVER_URL`
   - å€¼ï¼š`wss://your-server.railway.app`

2. ä¿®æ”¹ä»£ç ä»¥æ”¯æŒä»ç¯å¢ƒå˜é‡è¯»å–ï¼ˆéœ€è¦æ„å»ºæ­¥éª¤ï¼‰

---

## æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **æ‰“å¼€ä¸»æ¸¸æˆç•Œé¢**
   - è®¿é—®ï¼š`https://your-site.netlify.app/index.html?ws=wss://your-server.railway.app`
   - å®Œæˆç©å®¶è®¾ç½®
   - æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œåº”è¯¥çœ‹åˆ°ï¼š`å·²è¿æ¥åˆ°WebSocketæœåŠ¡å™¨`

2. **æ‰“å¼€ç©å®¶ç«¯**
   - åœ¨æ–°æ ‡ç­¾é¡µæˆ–æ–°è®¾å¤‡è®¿é—®ï¼š`https://your-site.netlify.app/player.html?ws=wss://your-server.railway.app`
   - å®Œæˆç©å®¶è®¾ç½®
   - å‘é€å¼¹å¹•

3. **éªŒè¯åŒæ­¥**
   - åœ¨ä¸»æ¸¸æˆç•Œé¢åº”è¯¥èƒ½çœ‹åˆ°ç©å®¶ç«¯å‘é€çš„å¼¹å¹•
   - æ£€æŸ¥æˆ˜æ–—æ—¥å¿—æ˜¯å¦æ˜¾ç¤ºä¼¤å®³

### è°ƒè¯•æŠ€å·§

å¦‚æœè¿æ¥å¤±è´¥ï¼Œæ£€æŸ¥ï¼š

1. **WebSocketæœåŠ¡å™¨æ˜¯å¦è¿è¡Œ**
   - æŸ¥çœ‹Railway/Renderæ—¥å¿—
   - ç¡®è®¤æœåŠ¡å™¨æ­£åœ¨ç›‘å¬

2. **URLæ˜¯å¦æ­£ç¡®**
   - ç¡®ä¿ä½¿ç”¨ `wss://`ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
   - ç¡®ä¿åŸŸåæ­£ç¡®

3. **é˜²ç«å¢™/ç½‘ç»œé—®é¢˜**
   - æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
   - å°è¯•ä½¿ç”¨WebSocketæµ‹è¯•å·¥å…·

---

## å¸¸è§é—®é¢˜

### Q1: Railway/Renderéƒ¨ç½²åæ— æ³•è¿æ¥ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- ç¡®è®¤ä½¿ç”¨ `wss://` è€Œä¸æ˜¯ `ws://`ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨å®‰å…¨è¿æ¥ï¼‰
- æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—ï¼Œç¡®è®¤æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ç«¯å£é…ç½®æ˜¯å¦æ­£ç¡®

### Q2: RenderæœåŠ¡ä¼‘çœ æ€ä¹ˆåŠï¼Ÿ

**A**: å‡ ä¸ªè§£å†³æ–¹æ¡ˆï¼š
- ä½¿ç”¨å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚UptimeRobotï¼‰å®šæœŸpingä½ çš„æœåŠ¡å™¨
- å‡çº§åˆ°ä»˜è´¹è®¡åˆ’
- ä½¿ç”¨Railwayï¼ˆå…è´¹ç‰ˆä¸ä¼‘çœ ï¼‰

### Q3: å¦‚ä½•æ›´æ–°éƒ¨ç½²ï¼Ÿ

**A**: 
- **Netlify**: æ¨é€åˆ°Gitä»“åº“ï¼Œè‡ªåŠ¨è§¦å‘éƒ¨ç½²
- **Railway/Render**: æ¨é€åˆ°Gitä»“åº“ï¼Œè‡ªåŠ¨è§¦å‘éƒ¨ç½²

### Q4: å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ

**A**:
- **Railway**: é¡¹ç›®é¡µé¢ â†’ "View Logs"
- **Render**: Dashboard â†’ é€‰æ‹©æœåŠ¡ â†’ "Logs"

### Q5: å¦‚ä½•é…ç½®è‡ªå®šä¹‰åŸŸåï¼Ÿ

**A**: 
- **Netlify**: Domain settings â†’ Add custom domain
- **Railway/Render**: åœ¨æœåŠ¡è®¾ç½®ä¸­é…ç½®è‡ªå®šä¹‰åŸŸå

---

## å¿«é€Ÿæ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰ç¡®ä¿ï¼š
- [ ] æ‰€æœ‰æ–‡ä»¶å·²æäº¤åˆ°Gitä»“åº“
- [ ] `package.json` åŒ…å« `ws` ä¾èµ–
- [ ] `server.js` æ­£ç¡®é…ç½®ç«¯å£ï¼ˆä½¿ç”¨ç¯å¢ƒå˜é‡ï¼‰

éƒ¨ç½²åæ£€æŸ¥ï¼š
- [ ] Railway/Renderæ˜¾ç¤ºéƒ¨ç½²æˆåŠŸ
- [ ] æœåŠ¡å™¨æ—¥å¿—æ˜¾ç¤ºæ­£åœ¨ç›‘å¬
- [ ] Netlifyæ˜¾ç¤ºéƒ¨ç½²æˆåŠŸ
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºè¿æ¥æˆåŠŸ
- [ ] å¯ä»¥å‘é€å’Œæ¥æ”¶å¼¹å¹•

---

## ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ

1. **ä½¿ç”¨HTTPS/WSS**
   - æ‰€æœ‰è¿æ¥éƒ½ä½¿ç”¨å®‰å…¨åè®®ï¼ˆwss://ï¼‰

2. **ç›‘æ§å’Œæ—¥å¿—**
   - å®šæœŸæ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
   - è®¾ç½®é”™è¯¯å‘Šè­¦

3. **æ€§èƒ½ä¼˜åŒ–**
   - è€ƒè™‘ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº
   - ä¼˜åŒ–å›¾ç‰‡å¤§å°

4. **å¤‡ä»½**
   - å®šæœŸå¤‡ä»½é…ç½®
   - ä½¿ç”¨Gitç®¡ç†ä»£ç 

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
3. éªŒè¯URLå’Œé…ç½®æ˜¯å¦æ­£ç¡®
4. æµ‹è¯•WebSocketè¿æ¥æ˜¯å¦æ­£å¸¸

ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼ğŸ®
