<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <title>弹幕BOSS战 - 年会游戏</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <!-- 开始游戏面板 -->
        <div id="playerSetup" class="setup-panel">
            <h2>弹幕BOSS战</h2>
            <div class="setup-content">
                <div class="connection-status-section">
                    <div class="status-item">
                        <span class="status-label">服务器状态：</span>
                        <span id="serverStatus" class="status-indicator">连接中...</span>
                    </div>
                    <div id="serverStatusDetail" class="status-detail" style="display: none;"></div>
                </div>
                <div class="start-game-section">
                    <p class="game-description">观看其他玩家发送弹幕攻击BOSS</p>
                    <button id="confirmSetup" class="btn btn-primary btn-large">开始游戏</button>
                </div>
            </div>
        </div>

        <!-- 游戏主界面 -->
        <div id="gameArea" class="game-area" style="display: none;">
            <!-- 游戏画布 -->
            <canvas id="gameCanvas"></canvas>
            
            <!-- 设置按钮 -->
            <button id="openConfigBtn" class="config-btn" title="游戏设置">
                ⚙️ 设置
            </button>
            
            <!-- 版本号显示 -->
            <div class="version-display" id="versionDisplay" title="游戏版本号">
                v<span id="versionNumber">1.0.0.0</span>
            </div>
            
            <!-- 控制面板 -->
            <div class="control-panel">
                <div class="player-info">
                    <img id="currentPlayerAvatar" src="" alt="头像" class="player-avatar-small">
                    <span id="currentPlayerName">玩家</span>
                </div>
                <div class="input-section">
                    <input type="text" id="bulletInput" placeholder="输入弹幕内容..." maxlength="50">
                    <button id="sendBullet" class="btn btn-send">发送弹幕</button>
                </div>
            </div>

            <!-- BOSS信息显示 -->
            <div class="boss-info">
                <div class="boss-hp-bar">
                    <div class="hp-label">BOSS血量</div>
                    <div class="hp-bar-container">
                        <div id="hpBar" class="hp-bar"></div>
                    </div>
                    <div class="hp-text"><span id="currentHP">1000</span> / <span id="maxHP">1000</span></div>
                </div>
            </div>

            <!-- 战斗日志 -->
            <div class="battle-log" id="battleLog"></div>
        </div>

        <!-- 击杀者展示 -->
        <div id="killerDisplay" class="killer-display" style="display: none;">
            <div class="killer-content">
                <div class="killer-avatar-large">
                    <img id="killerAvatar" src="" alt="击杀者头像">
                </div>
                <div class="killer-name" id="killerName">玩家名字</div>
                <div class="killer-message">🎉 成功击杀 BOSS，恭喜获得大奖！🎉</div>
                <button id="playAgain" class="btn btn-primary">再来一次</button>
            </div>
        </div>

        <!-- 游戏配置面板 -->
        <div id="configPanel" class="config-panel" style="display: none;">
            <div class="config-content">
                <div class="config-header">
                    <h2>游戏设置</h2>
                    <button id="closeConfigBtn" class="close-btn">×</button>
                </div>
                <div class="config-body">
                    <div class="config-section">
                        <h3>BOSS设置</h3>
                        <div class="config-item">
                            <label>BOSS图片：</label>
                            <div class="boss-image-preview">
                                <img id="bossImagePreview" src="" alt="BOSS预览" style="display: none;">
                                <div class="boss-image-placeholder">点击上传BOSS图片</div>
                            </div>
                            <input type="file" id="bossImageInput" accept="image/*" style="display: none;">
                            <button id="uploadBossImageBtn" class="btn">上传BOSS图片</button>
                        </div>
                        <div class="config-item">
                            <label>BOSS血量：</label>
                            <input type="number" id="bossHP" min="100" max="10000" step="100">
                        </div>
                        <div class="config-item">
                            <label>BOSS移动速度：</label>
                            <input type="number" id="bossSpeed" min="0.1" max="5" step="0.1">
                        </div>
                    </div>
                    <div class="config-section">
                        <h3>弹幕设置</h3>
                        <div class="config-item">
                            <label>弹幕攻击力：</label>
                            <input type="number" id="bulletDamage" min="1" max="100" step="1">
                        </div>
                        <div class="config-item">
                            <label>弹幕移动速度：</label>
                            <input type="number" id="bulletSpeed" min="0.1" max="5" step="0.1">
                        </div>
                    </div>
                    <div class="config-section">
                        <h3>暴击设置</h3>
                        <div class="config-item">
                            <label>暴击率（%）：</label>
                            <input type="number" id="criticalRate" min="0" max="100" step="1">
                        </div>
                        <div class="config-item">
                            <label>暴击伤害倍数：</label>
                            <input type="number" id="criticalMultiplier" min="1" max="10" step="0.1">
                        </div>
                    </div>
                    <div class="config-section">
                        <h3>游戏统计</h3>
                        <div class="stats-container">
                            <div class="stats-ranking">
                                <h4>伤害输出排名</h4>
                                <div id="damageRanking" class="ranking-list"></div>
                            </div>
                            <div class="stats-ranking">
                                <h4>暴击次数排名</h4>
                                <div id="criticalRanking" class="ranking-list"></div>
                            </div>
                        </div>
                        <div class="config-item" style="margin-top: 15px;">
                            <button id="clearStatsBtn" class="btn" style="width: 100%; background: #ff6b6b; color: white;">清空统计数据</button>
                        </div>
                    </div>
                </div>
                <div class="config-footer">
                    <button id="saveConfigBtn" class="btn btn-primary">保存设置</button>
                    <button id="resetConfigBtn" class="btn">重置默认</button>
                </div>
            </div>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
